<html ng-app="palette">
<head>
    <title>Colour Palette generator</title>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
    <script>
        angular.module('palette', [])
        .controller('ColoursCtrl', function ($scope) {
            $scope.colours = [];
            $scope.removedColours = [];
            $scope.processColours = function () {
                $scope.colours = [];

                // Read in the hex values pasted in
                var colours = $('#colours').val().split(/[,\s\n]/g);
                for (var i = 0; i < colours.length; i++) {
                    if (colours[i]) {
                        if (colours[i][0] !== '#') colours[i] = '#' + colours[i];
                        if (colours[i].length !== 7) continue;
                        if (!/^[a-fA-F0-9]*$/.test(colours[i].substring(1))) continue; // Not a hex colour
                        $scope.colours.push(colours[i]);

                    }
                }
            };
            $scope.remove = function(index) {
				$scope.removedColours.push($scope.colours.splice(index,1));
			}
            $scope.calculateInverse = function(colour) {
                colour = colour.substring(1); // Remove #

                console.log(colour.substring(0,2),colour.substring(2,2),colour.substring(4,2), colour)
                var r = 255 - parseInt(colour.substring(0,2), 16);
                var g = 255 - parseInt(colour.substring(2,4), 16);
                var b = 255 - parseInt(colour.substring(4,6), 16);

                return "rgb("+r+","+g+","+b+")";
            }

        })
        .directive('showHover', function () {
            return {
                restrict: 'A',
                link: function (scope, element) {
                    element.hover(function () {
                        element.find('span').show();
                    });
                    element.mouseleave(function ($event) {
                        element.find('span').hide();
                    })
                }
            }

        });

    </script>
    <style>
        body {
            font-family: "Helvetica Neue", "Liberation Sans", "Droid Sans", "Lucida Sans Unicode", sans-serif;
        }

        .colour {
            width: 90px;
            height: 35px;
            border: 1px solid #323232;
            float: left;
            margin-top: -1px; /* Hide borders */
            margin-left: -1px;
            text-align: center;
        }
        .colour span {
            font-size: 13px;
            padding-top: 10px;
            display: inline-block;
            text-decoration: underline;
        }
		#colourPalette {
			float: left;
			margin-bottom: 10px;
		}
        textarea {
            width: 100%;
            height: 4em;
        }
        #selectedColours {
			clear: both;
			border: 1px solid #999;
			max-width: 100%;
			padding: 20px;
		}
		#pre {
			white-space: pre-line;
			background: #f8f8f8;
			padding: 20px;
			border: 1px solid #e9e9e9;
		}
    </style>
</head>
<body ng-controller="ColoursCtrl">
<h1>Colour Palette Viewer</h1>
<textarea id="colours" placeholder="Paste your Hex colours here"></textarea>
<button ng-click="processColours()">Show palette</button>
<hr/>
<h4 ng-show="colours.length > 0">Found {{ colours.length }} colours.</h4>
<p>Click on a colour to remove it.</p>
<div id="colourPalette">
    <div class="colour" ng-repeat="colour in colours" style="background: {{ colour }}" show-hover ng-click="remove($index)">
        <span style="display: none; color: {{ calculateInverse(colour) }}">{{colour}}</span>
    </div>
</div>
<div id="selectedColours" ng-show="colours.length > 0">
	<h2>Selected Colours</h2>
	<input type="checkbox" ng-model="arrayFormat"/>Show in Javascript Array Format<br />
	<input type="checkbox" ng-model="oneLine"/>Show all on one line<br />
	
	<div id="pre">
<span ng-repeat="colour in colours">{{ (arrayFormat)? '"': ''}}{{colour}}{{(arrayFormat)? '",':'' }} {{ (oneLine)? '':'\n' }}</span>
	</div>
</div>
</body>
</html>